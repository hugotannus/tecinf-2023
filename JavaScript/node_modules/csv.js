function printCSV(csvText) {
  const json = csv2JSON(csvText);
  
  console.table(json);
}

function csv2JSON (csvText, separator=';') {
  const lines = csvText.trim().split('\n');
  const keys = splitColumns(lines.shift());

  return lines.map(transformLine);

  function transformLine(line) {
    const columns = splitColumns(line);
    return columns.reduce(insertOnTuple, {});
  }

  function insertOnTuple(tuple,content, i) {
    tuple[keys[i]] = content;
    return tuple;
  }

  function splitColumns(line) {
    return line.trim().split(separator);
  }
}

function baixarCSV(csv, nomeArquivo) {
  const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
  const url = URL.createObjectURL(blob);
  const link = document.createElement("a");
  link.href = url;
  link.download = nomeArquivo;
  link.click();
}

module.exports = {
  baixarCSV,
  csv2JSON,
  printCSV,
}