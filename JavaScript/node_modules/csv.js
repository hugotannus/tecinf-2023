function csv2JSON (csvText) {
  const lines = csvText.trim().split('\n');
  const headers = lines.shift().trim().split(';');

  return lines.map(transformLine);

  function transformLine(line) {
    const tuple = {}
    const columns = line.trim().split(';')

    columns.forEach(insertOnTuple);

    return tuple;
    
    function insertOnTuple(content, i) {
      tuple[headers[i]] = content;
    }
  }

}

function baixarCSV(csv, nomeArquivo) {
  const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
  const url = URL.createObjectURL(blob);
  const link = document.createElement("a");
  link.href = url;
  link.download = nomeArquivo;
  link.click();
}

function printCSV(csvText) {
  const json = csv2JSON(csvText);

  console.table(json);
}

module.exports = {
  baixarCSV,
  csv2JSON,
  printCSV,
}